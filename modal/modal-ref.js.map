{"version":3,"file":"modal-ref.js","sourceRoot":"","sources":["../../src/modal/modal-ref.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable, ComponentRef, ViewRef, ViewContainerRef } from '@angular/core';\r\n\r\nimport { NgbModalBackdrop } from './modal-backdrop';\r\nimport { NgbModalWindow } from './modal-window';\r\n\r\nimport { ContentRef } from '../util/popup';\r\n\r\n/**\r\n * A reference to an active (currently opened) modal. Instances of this class\r\n * can be injected into components passed as modal content.\r\n */\r\n\r\nexport class NgbActiveModal {\r\n  /**\r\n   * Can be used to close a modal, passing an optional result.\r\n   */\r\n  close(result?: any): void { }\r\n\r\n  /**\r\n   * Can be used to dismiss a modal, passing an optional reason.\r\n   */\r\n  dismiss(reason?: any): void { }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n];\n}\r\n\r\n/**\r\n * A reference to a newly opened modal.\r\n */\r\n\r\nexport class NgbModalRef {\r\n  private _resolve: (result?: any) => void;\r\n  private _reject: (reason?: any) => void;\r\n\r\n  /**\r\n   * The instance of component used as modal's content.\r\n   * Undefined when a TemplateRef is used as modal's content.\r\n   */\r\n  get componentInstance(): any {\r\n    if (this._contentRef.componentRef) {\r\n      return this._contentRef.componentRef.instance;\r\n    }\r\n  }\r\n\r\n  // only needed to keep TS1.8 compatibility\r\n  set componentInstance(instance: any) { }\r\n\r\n  /**\r\n   * A promise that is resolved when a modal is closed and rejected when a modal is dismissed.\r\n   */\r\n  result: Promise<any>;\r\n\r\n  constructor(\r\n    private _viewContainerRef: ViewContainerRef, private _windowCmptRef: ComponentRef<NgbModalWindow>,\r\n    private _contentRef: ContentRef, private _backdropCmptRef?: ComponentRef<NgbModalBackdrop>) {\r\n    _windowCmptRef.instance.dismissEvent.subscribe((reason: any) => { this.dismiss(reason); });\r\n\r\n    this.result = new Promise((resolve, reject) => {\r\n      this._resolve = resolve;\r\n      this._reject = reject;\r\n    });\r\n    this.result.then(null, () => { });\r\n  }\r\n\r\n  /**\r\n   * Can be used to close a modal, passing an optional result.\r\n   */\r\n  close(result?: any): void {\r\n    if (this._windowCmptRef) {\r\n      this._resolve(result);\r\n      this._removeModalElements();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Can be used to dismiss a modal, passing an optional reason.\r\n   */\r\n  dismiss(reason?: any): void {\r\n    if (this._windowCmptRef) {\r\n      this._reject(reason);\r\n      this._removeModalElements();\r\n    }\r\n  }\r\n\r\n  private _removeModalElements() {\r\n    try {\r\n      this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._windowCmptRef.hostView));\r\n    } catch (e) { }\r\n    if (this._backdropCmptRef) {\r\n      this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._backdropCmptRef.hostView));\r\n    }\r\n    if (this._contentRef && this._contentRef.viewRef) {\r\n      this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._contentRef.viewRef));\r\n    }\r\n\r\n    this._windowCmptRef = null;\r\n    this._backdropCmptRef = null;\r\n    this._contentRef = null;\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: ({type: any, decorators?: DecoratorInvocation[]}|null)[] = [\n{type: ViewContainerRef, },\n{type: ComponentRef, },\n{type: ContentRef, },\n{type: ComponentRef, },\n];\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}